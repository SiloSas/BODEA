<div class="column large-12 table-title-container">
    <div class="column medium-2 table-title">
        <div class="column md-whiteframe-z1">
            Numero
            <i class="fa"
              ng-class="{'fa-chevron-down': predicate != 'id' || (predicate == 'id' && reverse == false),
              'fa-chevron-up': predicate == 'id' && reverse == true}"
              ng-click="order('id')"></i>
        </div>
    </div>
    <div class="column medium-2 table-title">
        <div class="column md-whiteframe-z1">
            Magasin
            <i class="fa"
               ng-class="{'fa-chevron-down': predicate != 'store' || (predicate == 'store' && reverse == false),
              'fa-chevron-up': predicate == 'store' && reverse == true}"
               ng-click="order('store')"></i>
        </div>
    </div>
    <div class="column medium-2 table-title">
        <div class="column md-whiteframe-z1">
            Date
            <i class="fa"
               ng-class="{'fa-chevron-down': predicate != 'date' || (predicate == 'date' && reverse == false),
              'fa-chevron-up': predicate == 'date' && reverse == true}"
               ng-click="order('date')"></i>
        </div>
    </div>
    <div class="column medium-2 table-title">
        <div class="column md-whiteframe-z1">
            Etat
            <i class="fa"
               ng-class="{'fa-chevron-down': predicate != 'state' || (predicate == 'state' && reverse == false),
              'fa-chevron-up': predicate == 'state' && reverse == true}"
               ng-click="order('state')"></i>
        </div>
    </div>
    <div class="column medium-2 table-title">
        <div class="column md-whiteframe-z1">
            Modifier
        </div>
    </div>
    <div class="column medium-2 table-title">
        <div class="column md-whiteframe-z1">
            Supprimer
        </div>
    </div>
</div>
<div class="column large-12" md-theme="commandeTheme" ng-repeat="commande in commandes | filter: filter | orderBy:predicate:reverse">
    <md-divider class="column large-12" ng-if="!$first"></md-divider>
    <div class="padding10 float-left width100p">
        <div class="width100p float-left center" ng-show="!refactor">
            <div class="column medium-2">{{commande.id}}</div>
            <div class="column medium-2">{{commande.brand}}</div>
            <div class="column medium-2">{{commande.date}}</div>
            <div class="column medium-2">{{commande.state}}</div>
            <i class="column medium-2 pointer fa fa-pencil"
               ng-click="copyCommande($index); refactor = true"></i>
            <i class="column medium-2 pointer fa fa-trash" ng-click="confirmRemove = !confirmRemove"></i>
        </div>
        <div ng-if="confirmRemove" class="float-right md-whiteframe-z1">
           <div class="float-left padding10">
               Etes-vous sur de vouloir suprimer cette commande ?
            <md-button class="md-primary md-raised" ng-click="$parent.confirmRemove = false; remove($index)">
                Oui
            </md-button>
            <md-button class="md-primary md-raised" ng-click="$parent.confirmRemove = false">
                Non
            </md-button>
           </div>
        </div>
        <md-list ng-if="refactor" class="md-whiteframe-z1">
            <form ng-submit="refactorCommande($index); $parent.refactor = false">
                <i class="md-warn relative fa fa-times-circle"
                   style="  font-size: 30px;right: -15px;float: right;top: -22px;"
                   ng-click="$parent.refactor = false"></i>
                <md-subheader>Modifer la commande {{commande.id}}</md-subheader>
                <md-divider></md-divider>
                <md-input-container class="column large-4">
                    <label>Numéro de la commande</label>
                    <input type="text" ng-model="commande.newCommande.id">
                </md-input-container>
                <md-input-container class="column large-4">
                    <label>Référence de la commande</label>
                    <input type="text" ng-model="commande.newCommande.ref">
                </md-input-container>
                <md-input-container>
                    <label>Date de livraison (JJ/MM/AAAA)</label>
                    <input type="date" ng-model="commande.newCommande.deliveryDate">
                </md-input-container>
                <md-list>
                    <md-subheader>Etat :</md-subheader>
                    <md-divider></md-divider>
                    <md-list-item>
                        <md-radio-group ng-model="commande.newCommande.state">
                            <md-radio-button value="1" class="md-accent marginLeft0">Commande en préparation</md-radio-button>
                            <md-radio-button value="2" class="md-accent md-hue-1 marginLeft0"> Commande validée </md-radio-button>
                            <md-radio-button value="3" class="md-accent md-hue-2 marginLeft0">En cours de traitement</md-radio-button>
                            <md-radio-button value="4" class="md-primary marginLeft0">En cours de livraison</md-radio-button>
                            <md-radio-button value="5" class="md-accent md-hue-3 marginLeft0">Livré</md-radio-button>
                        </md-radio-group>
                    </md-list-item>
                </md-list>
                <md-list>
                    <md-subheader>Visuel</md-subheader>
                    <md-divider></md-divider>
                    <md-list-item>
                        <div class="column large-12 padding0">
                            <a class="md-primary md-button margin10 md-default-theme" ng-click="showImage = !showImage">Voir {{commande.image.name}}</a>
                            <a class="md-primary md-button margin10 md-default-theme" href="{{commande.image.url}}" download="{{commande.image.name}}">Telecharger {{commande.image.name}}</a>
                            <div class="column large-12 md-whiteframe-z1 padding10" ng-if="showImage">
                                <i class="float-right fa fa-times pointer" ng-click="$parent.showImage = false"></i>
                                <img ng-src="{{commande.image.url}}" class="width100p">
                            </div>
                        </div>
                    </md-list-item>
                </md-list>
                <md-subheader ng-init="index = $index" class="md-no-sticky">Details de la commande</md-subheader>
                <md-list ng-repeat="subOrder in commande.subOrders">
                    <md-divider></md-divider>
                    <md-list-item>
                        <p class="column medium-4">Magasin</p>
                        <p>{{subOrder.store}}</p>
                    </md-list-item>
                    <md-list-item>
                        <p class="column medium-4">Adresse de livraison</p>
                        <p>{{subOrder.deliveryAddress}}</p>
                    </md-list-item>
                    <md-list-item>
                        <p class="column medium-4">Nombre de bâches</p>
                        <p>{{subOrder.numberItems}}</p>
                    </md-list-item>
                    <md-list-item>
                        <p class="column medium-4">Prix</p>
                        <p>{{subOrder.price}} €</p>
                    </md-list-item>
                    <md-list-item>
                        <p class="column medium-4">Poids</p>
                        <p>{{subOrder.weight}} kg</p>
                    </md-list-item>
                    <md-list-item ng-if="commande.newCommande.state != 1 && commande.newCommande.state != 2">
                        <p class="column medium-4">Livré</p>
                        <md-switch class="md-accent md-hue-3"
                                   ng-change="changeState(index)"
                                   ng-model="subOrder.delivered"></md-switch>
                    </md-list-item>
                </md-list>
                <md-button class="md-primary md-raised" type="submit">Valider</md-button>
                <md-button class="md-warn md-raised" ng-click="$parent.refactor = false" type="submit">Annuler</md-button>
            </form>
        </md-list>
    </div>
</div>

