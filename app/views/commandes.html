<div class="column large-12 table-title-container">
    <div class="column medium-2 table-title">
        <div class="column md-whiteframe-z1">
            Numero
            <i class="fa"
              ng-class="{'fa-chevron-down': predicate != 'id' || (predicate == 'id' && reverse == false),
              'fa-chevron-up': predicate == 'id' && reverse == true}"
              ng-click="order('id')"></i>
        </div>
    </div>
    <div class="column medium-2 table-title">
        <div class="column md-whiteframe-z1">
            Enseigne
            <i class="fa"
               ng-class="{'fa-chevron-down': predicate != 'brand' || (predicate == 'brand' && reverse == false),
              'fa-chevron-up': predicate == 'brand' && reverse == true}"
               ng-click="order('brand')"></i>
        </div>
    </div>
    <div class="column medium-2 table-title">
        <div class="column md-whiteframe-z1">
            Date
            <i class="fa"
               ng-class="{'fa-chevron-down': predicate != 'date' || (predicate == 'date' && reverse == false),
              'fa-chevron-up': predicate == 'date' && reverse == true}"
               ng-click="order('date')"></i>
        </div>
    </div>
    <div class="column medium-2 table-title">
        <div class="column md-whiteframe-z1">
            Etat
            <i class="fa"
               ng-class="{'fa-chevron-down': predicate != 'state' || (predicate == 'state' && reverse == false),
              'fa-chevron-up': predicate == 'state' && reverse == true}"
               ng-click="order('state')"></i>
        </div>
    </div>
    <div class="column medium-2 table-title">
        <div class="column md-whiteframe-z1">
            Modifier
        </div>
    </div>
    <div class="column medium-2 table-title">
        <div class="column md-whiteframe-z1">
            Supprimer
        </div>
    </div>
</div>
<div class="column large-12" md-theme="commandeTheme"
     ng-repeat="order in filteredOrders = (orders | filter: filter) | orderBy:predicate:reverse | limitTo: limit">
    <md-divider class="column large-12" ng-if="!$first"></md-divider>
    <div class="padding10 float-left width100p">
        <div class="width100p float-left center" ng-show="!refactor">
            <h5 class="column medium-2">{{order.id}}</h5>
            <h5 class="column medium-2">{{order.brand}}</h5>
            <h5 class="column medium-2">{{order.date}}</h5>
            <div class="column medium-2">
                <md-button class="md-fab md-mini"
                        ng-class="{'md-accent': order.state == 1, 'md-accent md-hue-1': order.state == 2,
                        'md-accent md-hue-2': order.state == 3, 'md-primary': order.state == 4,
                        'md-accent md-hue-3': order.state == 5}"></md-button></div>
            <h5><i class="column medium-2 pointer fa fa-pencil"
               ng-click="copyCommande($index); refactor = true"></i></h5>
            <h5><i class="column medium-2 pointer fa fa-trash" ng-click="confirmRemove = !confirmRemove"></i></h5>
        </div>
        <div ng-if="confirmRemove" class="float-right md-whiteframe-z1">
           <div class="float-left padding10">
               Etes-vous sur de vouloir suprimer cette commande ?
            <md-button class="md-primary md-raised" ng-click="$parent.confirmRemove = false; remove($index)">
                Oui
            </md-button>
            <md-button class="md-primary md-raised" ng-click="$parent.confirmRemove = false">
                Non
            </md-button>
           </div>
        </div>
        <md-list ng-if="refactor" class="md-whiteframe-z1">
            <form ng-submit="refactorCommande($index); $parent.refactor = false">
                <i class="md-warn relative fa fa-times-circle"
                   style="  font-size: 30px;right: -15px;float: right;top: -22px;"
                   ng-click="$parent.refactor = false"></i>
                <md-subheader>Modifer la commande {{order.id}}</md-subheader>
                <md-divider></md-divider>
                <md-input-container class="column large-4">
                    <label>Numéro de la commande</label>
                    <input type="text" ng-model="order.newOrder.id">
                </md-input-container>
                <md-input-container class="column large-4">
                    <label>Référence de la commande</label>
                    <input type="text" ng-model="order.newOrder.ref">
                </md-input-container>
                <md-input-container>
                    <label>Date de livraison (JJ/MM/AAAA)</label>
                    <input type="date" ng-model="order.newOrder.deliveryDate">
                </md-input-container>
                <md-list>
                    <md-subheader>Prix total</md-subheader>
                    <md-divider></md-divider>
                    <md-list-item>
                        <b>{{order.price}} €</b>
                    </md-list-item>
                </md-list>
                <md-list>
                    <md-subheader>Nombre total de baches</md-subheader>
                    <md-divider></md-divider>
                    <md-list-item>
                        <b>{{order.numberItems}}</b>
                    </md-list-item>
                </md-list>
                <md-list>
                    <md-subheader>Poid total</md-subheader>
                    <md-divider></md-divider>
                    <md-list-item>
                        <b>{{order.weight}}</b>
                    </md-list-item>
                </md-list>
                <md-list>
                    <md-subheader>Etat :</md-subheader>
                    <md-divider></md-divider>
                    <md-list-item>
                        <md-radio-group ng-model="order.newOrder.state">
                            <md-radio-button value="1" class="md-accent marginLeft0">Commande en préparation</md-radio-button>
                            <md-radio-button value="2" class="md-accent md-hue-1 marginLeft0"> Commande validée </md-radio-button>
                            <md-radio-button value="3" class="md-accent md-hue-2 marginLeft0">En cours de traitement</md-radio-button>
                            <md-radio-button value="4" class="md-primary marginLeft0">En cours de livraison</md-radio-button>
                            <md-radio-button value="5" class="md-accent md-hue-3 marginLeft0">Livré</md-radio-button>
                        </md-radio-group>
                    </md-list-item>
                </md-list>
                <md-list>
                    <md-subheader>Visuel</md-subheader>
                    <md-divider></md-divider>
                    <md-list-item>
                        <div class="column large-12 padding0">
                            <a class="md-primary md-button margin10 md-default-theme" ng-click="showImage = !showImage">Voir {{order.image.name}}</a>
                            <a class="md-primary md-button margin10 md-default-theme" href="{{order.image.url}}" download="{{order.image.name}}">Telecharger {{order.image.name}}</a>
                            <div class="column large-12 md-whiteframe-z1 padding10" ng-if="showImage">
                                <i class="float-right fa fa-times pointer" ng-click="$parent.showImage = false"></i>
                                <img ng-src="{{order.image.url}}" class="width100p">
                            </div>
                        </div>
                    </md-list-item>
                </md-list>
                <md-subheader ng-init="index = $index" class="md-no-sticky">Details de la commande</md-subheader>
                <md-list ng-repeat="subOrder in order.subOrders">
                    <md-divider></md-divider>
                    <md-list-item>
                        <p class="column medium-4">Magasin</p>
                        <p>{{subOrder.store}}</p>
                    </md-list-item>
                    <md-list-item>
                        <p class="column medium-4">Adresse de livraison</p>
                        <p>{{subOrder.deliveryAddress}}</p>
                    </md-list-item>
                    <md-list-item>
                        <p class="column medium-4">Nombre de bâches</p>
                        <p>{{subOrder.numberItems}}</p>
                    </md-list-item>
                    <md-list-item>
                        <p class="column medium-4">Prix</p>
                        <p>{{subOrder.price}} €</p>
                    </md-list-item>
                    <md-list-item>
                        <p class="column medium-4">Poids</p>
                        <p>{{subOrder.weight}} kg</p>
                    </md-list-item>
                    <md-list-item ng-if="order.newOrder.state != 1 && order.newOrder.state != 2">
                        <p class="column medium-4">Livré</p>
                        <md-switch class="md-accent md-hue-3"
                                   ng-change="changeState(index)"
                                   ng-model="subOrder.delivered"></md-switch>
                    </md-list-item>
                </md-list>
                <md-button class="md-primary md-raised" type="submit">Valider</md-button>
                <md-button class="md-warn md-raised" ng-click="$parent.refactor = false">Annuler</md-button>
            </form>
        </md-list>
    </div>
</div>
<md-button ng-show="filteredOrders.length > limit"
           ng-click="limit = limit + 20"
        class="md-primary md-raised">Voir plus</md-button>

