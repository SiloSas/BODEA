<div class="column large-12 table-title-container">
    <div class="column medium-2 table-title">
        <div class="column md-whiteframe-z1 float-left">
            Nom
            <i class="fa"
               ng-class="{'fa-chevron-down': predicate != 'name' || (predicate == 'name' && reverse == false),
              'fa-chevron-up': predicate == 'name' && reverse == true}"
               ng-click="order('name')"></i>
        </div>
    </div>
    <div class="column medium-2 table-title">
        <div class="column md-whiteframe-z1 float-left">
            Prénom
            <i class="fa"
               ng-class="{'fa-chevron-down': predicate != 'firstName' || (predicate == 'firstName' && reverse == false),
              'fa-chevron-up': predicate == 'firstName' && reverse == true}"
               ng-click="order('firstName')"></i>
        </div>
    </div>
    <div class="column medium-2 table-title float-left">
        <div class="column md-whiteframe-z1">
            Enseigne
            <i class="fa"
               ng-class="{'fa-chevron-down': predicate != 'brand.name' || (predicate == 'brand.name' && reverse == false),
              'fa-chevron-up': predicate == 'brand.name' && reverse == true}"
               ng-click="order('brand.name')"></i>
        </div>
    </div>
    <div class="column medium-2 table-title float-left">
        <div class="column md-whiteframe-z1">
            Actif
            <i class="fa"
               ng-class="{'fa-chevron-down': predicate != 'isActive' || (predicate == 'isActive' && reverse == false),
              'fa-chevron-up': predicate == 'isActive' && reverse == true}"
               ng-click="order('isActive')"></i>
        </div>
    </div>
    <md-button class="md-primary md-raised column medium-4 marginLeft0 marginRight0"
               ng-click="createUser = true">Ajouter un utilisateur
    </md-button>
</div>
<div class="md-whiteframe-z1 width100p" ng-if="createUser">
    <form ng-submit="addUser(); $parent.createUser = false">
        <i class="md-warn relative fa fa-times-circle"
           style="font-size: 30px;right: -15px;float: right;top: -22px;"
           ng-click="$parent.createUser = false"></i>
        <md-subheader>Ajouter un utilisateur</md-subheader>
        <md-divider></md-divider>
        <md-input-container>
            <label>Nom</label>
            <input type="text" ng-model="newUser.name">
        </md-input-container>
        <md-input-container>
            <label>Prénom</label>
            <input type="text" ng-model="newUser.firstName">
        </md-input-container>
        <md-input-container>
            <label>Identifiant</label>
            <input type="text" ng-model="newUser.id">
        </md-input-container>
        <md-input-container>
            <label>E-mail</label>
            <input type="email" ng-model="newUser.mail">
        </md-input-container>
        <div class="column large-12 padding0">
            <md-input-container ng-init="password = 'password'" class="column medium-8 padding0">
                <label>Mot de passe</label>
                <input type="{{password}}" ng-model="newUser.password">
            </md-input-container>
            <a class="md-button md-primary md-default-theme column medium-4 padding0 margin0 absolute bottom0">
                <span ng-if="password == 'password'" ng-click="$parent.password = 'text'">Voir le password</span>
                <span ng-if="password == 'text'" ng-click="$parent.password = 'password'">Cacher le password</span>
            </a>
        </div>
        <md-input-container>
            <label>Fonction</label>
            <input type="text" ng-model="newUser.job">
        </md-input-container>
        <md-select ng-model="newUser.countType" placeholder="Type de compte">
            <md-option value="1">Admin</md-option>
            <md-option value="2">Client</md-option>
        </md-select>
        <md-autocomplete flex required
                         md-autofocus="false"
                         md-no-cache="noCache"
                         md-selected-item="newUser.brand"
                         md-search-text-change="searchTextChange(searchBrand)"
                         md-search-text="searchBrand"
                         md-selected-item-change="selectedBrandChange(brand)"
                         md-items="brand in querySearchBrand(searchBrand)"
                         md-item-text="brand.name"
                         md-floating-label="Enseigne (cliquez pour valider votre choix)">
            <md-item-template>
                <span md-highlight-text="searchBrand" md-highlight-flags="^i">{{brand.name}}</span>
            </md-item-template>
            <md-not-found>
                No matches found for "{{searchBrand}}".
            </md-not-found>
        </md-autocomplete>
        <md-subheader>Magasins</md-subheader>
        <md-divider></md-divider>
        <div ng-init="limit = 20">
            <div flex="50"
                 ng-repeat="store in filtredStores =(stores | filter: newUser.brand.name) | limitTo: limit">
                <md-checkbox ng-checked="exists(store, newUser.stores)" ng-click="toggle(store, newUser.stores)">
                    {{ store.name }}
                </md-checkbox>
            </div>
            <a class="md-primary md-button md-default-theme md-raised"
               ng-show="filtredStores.length > limit"
               ng-click="limit = limit+20"
                    >Voir plus de magasins</a>
        </div>
        <md-button class="md-primary md-raised" type="submit">Valider</md-button>
        <md-button class="md-warn md-raised" ng-click="$parent.createUser = false">Annuler</md-button>
    </form>
</div>
<div class="column large-12" ng-repeat="user in filteredUsers = (users | filter: filter) | orderBy:predicate:reverse | limitTo: limit">
    <md-divider class="column large-12" ng-if="!$first"></md-divider>
    <div class="padding10 float-left width100p">
        <div class="width100p float-left center" ng-show="!refactor">
            <h5 class="column medium-2">{{user.name}}</h5>
            <h5 class="column medium-2">{{user.firstName}}</h5>
            <h5 class="column medium-2">{{user.brand.name}}</h5>
            <h3 class="column medium-2">
                <md-checkbox style="margin: 0 0 0 50%"
                             ng-change="changeActiveUser(user)"
                             ng-model="user.isActive" class="md-primary" aria-label="Actif">
                </md-checkbox>
            </h3>
            <h5><i class="column medium-2 pointer fa fa-pencil"
                   ng-click="copyUser(user); refactor = true"></i></h5>
            <h5><i class="column medium-2 pointer fa fa-trash" ng-click="confirmRemove = !confirmRemove"></i></h5>
        </div>
        <div ng-if="confirmRemove" class="float-right md-whiteframe-z1">
            <div class="float-left padding10">
                Etes-vous sur de vouloir suprimer ce utilisateur ?
                <md-button class="md-primary md-raised" ng-click="$parent.confirmRemove = false; remove(user)">
                    Oui
                </md-button>
                <md-button class="md-primary md-raised" ng-click="$parent.confirmRemove = false">
                    Non
                </md-button>
            </div>
        </div>
        <md-list ng-if="refactor" class="md-whiteframe-z1">
            <form ng-submit="refactorUser(user); $parent.user = user.newUser; $parent.refactor = false">
                <i class="md-warn relative fa fa-times-circle"
                   style="font-size: 30px;right: -15px;float: right;top: -22px;"
                   ng-click="$parent.refactor = false"></i>
                <md-subheader>Modifer le utilisateur {{user.name}}</md-subheader>
                <md-divider></md-divider>
                <md-input-container>
                    <label>Nom</label>
                    <input type="text" ng-model="user.newUser.name">
                </md-input-container>
                <md-input-container>
                    <label>Prénom</label>
                    <input type="text" ng-model="user.newUser.firstName">
                </md-input-container>
                <md-input-container>
                    <label>Identifiant</label>
                    <input type="text" ng-model="user.newUser.id">
                </md-input-container>
                <md-input-container>
                    <label>E-mail</label>
                    <input type="email" ng-model="user.newUser.mail">
                </md-input-container>
                <div class="column large-12 padding0">
                    <md-input-container ng-init="password = 'password'" class="column medium-8 padding0">
                        <label>Mot de passe</label>
                        <input type="{{password}}" ng-model="user.newUser.password">
                    </md-input-container>
                    <a class="md-button md-primary md-default-theme column medium-4 padding0 margin0 absolute bottom0">
                        <span ng-if="password == 'password'" ng-click="$parent.password = 'text'">Voir le password</span>
                        <span ng-if="password == 'text'" ng-click="$parent.password = 'password'">Cacher le password</span>
                    </a>
                </div>
                <md-input-container>
                    <label>Fonction</label>
                    <input type="text" ng-model="user.newUser.job">
                </md-input-container>
                <md-select ng-model="user.newUser.countType" placeholder="Type de compte">
                    <md-option value="1">Admin</md-option>
                    <md-option value="2">Client</md-option>
                </md-select>
                <md-autocomplete flex required
                                 md-autofocus="false"
                                 md-no-cache="noCache"
                                 md-selected-item="user.newUser.brand"
                                 md-search-text-change="searchTextChange(searchBrand)"
                                 md-search-text="searchBrand"
                                 md-selected-item-change="selectedBrandChange(brand)"
                                 md-items="brand in querySearchBrand(searchBrand)"
                                 md-item-text="brand.name"
                                 md-floating-label="Enseigne (cliquez pour valider votre choix)">
                    <md-item-template>
                        <span md-highlight-text="searchBrand" md-highlight-flags="^i">{{brand.name}}</span>
                    </md-item-template>
                    <md-not-found>
                        No matches found for "{{searchBrand}}".
                    </md-not-found>
                </md-autocomplete>
                <md-subheader>Magasins</md-subheader>
                <md-divider></md-divider>
                <div ng-init="limit = 20">
                    <div flex="50"
                     ng-repeat="store in filtredStores =(stores | filter: user.newUser.brand.name) | limitTo: limit">
                        <md-checkbox ng-checked="exists(store, user.newUser.stores)" ng-click="toggle(store, user.newUser.stores)">
                            {{ store.name }}
                        </md-checkbox>
                    </div>
                    <a class="md-primary md-button md-default-theme md-raised"
                       ng-show="filtredStores.length > limit"
                       ng-click="limit = limit+20"
                            >Voir plus de magasins</a>
                </div>
                <md-button class="md-primary md-raised" type="submit">Valider</md-button>
                <md-button class="md-warn md-raised" ng-click="$parent.refactor = false">Annuler</md-button>
            </form>
        </md-list>
    </div>
</div>
<md-button ng-show="filteredUsers.length > limit"
           ng-click="limit = limit + 20"
           class="md-primary md-raised">Voir plus</md-button>