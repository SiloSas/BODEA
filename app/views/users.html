<div class="column large-12 table-title-container">
    <div class="column medium-2 table-title">
        <div class="column md-whiteframe-z1 float-left">
            Nom
            <i class="fa"
               ng-class="{'fa-chevron-down': predicate != 'name' || (predicate == 'name' && reverse == false),
              'fa-chevron-up': predicate == 'name' && reverse == true}"
               ng-click="order('name')"></i>
        </div>
    </div>
    <div class="column medium-2 table-title">
        <div class="column md-whiteframe-z1 float-left">
            Prénom
            <i class="fa"
               ng-class="{'fa-chevron-down': predicate != 'fistName' || (predicate == 'fistName' && reverse == false),
              'fa-chevron-up': predicate == 'fistName' && reverse == true}"
               ng-click="order('fistName')"></i>
        </div>
    </div>
    <div class="column medium-2 table-title float-left">
        <div class="column md-whiteframe-z1">
            Enseigne
            <i class="fa"
               ng-class="{'fa-chevron-down': predicate != 'brand.name' || (predicate == 'brand.name' && reverse == false),
              'fa-chevron-up': predicate == 'brand.name' && reverse == true}"
               ng-click="order('brand.name')"></i>
        </div>
    </div>
    <div class="column medium-2 table-title float-left">
        <div class="column md-whiteframe-z1">
            Actif
            <i class="fa"
               ng-class="{'fa-chevron-down': predicate != 'isActive' || (predicate == 'isActive' && reverse == false),
              'fa-chevron-up': predicate == 'isActive' && reverse == true}"
               ng-click="order('isActive')"></i>
        </div>
    </div>
    <md-button class="md-primary md-raised column medium-4 marginLeft0 marginRight0"
               ng-click="createUser = true">Ajouter un utilisateur
    </md-button>
</div>
<div class="md-whiteframe-z1 width100p" ng-if="createUser">
    <form ng-submit="addUser(); $parent.createUser = false">
        <i class="md-warn relative fa fa-times-circle"
           style="font-size: 30px;right: -15px;float: right;top: -22px;"
           ng-click="$parent.createUser = false"></i>
        <md-subheader>Ajouter un utilisateur</md-subheader>
        <md-divider></md-divider>
        <md-input-container>
            <label>Nom</label>
            <input type="text" ng-model="newUser.name">
        </md-input-container>
        <md-input-container>
            <label>Prénom</label>
            <input type="text" ng-model="newUser.firstName">
        </md-input-container>
        <md-input-container>
            <label>Identifiant</label>
            <input type="text" ng-model="newUser.id">
        </md-input-container>
        <md-input-container>
            <label>E-mail</label>
            <input type="email" ng-model="newUser.mail">
        </md-input-container>
        <md-input-container>
            <label>Mot de passe</label>
            <input type="password" ng-model="newUser.password">
        </md-input-container>
        <md-input-container>
            <label>Fonction</label>
            <input type="text" ng-model="newUser.function">
        </md-input-container>
        <md-select ng-model="newUser.countType" placeholder="Type de compte">
            <md-option value="1">Admin</md-option>
            <md-option value="2">Client</md-option>
        </md-select>
        <md-autocomplete flex required
                         md-no-cache="noCache"
                         md-selected-item="newUser.brand"
                         md-search-text-change="searchTextChange(searchBrand)"
                         md-search-text="searchBrand"
                         md-selected-item-change="selectedBrandChange(brand)"
                         md-items="brand in querySearchBrand(searchBrand)"
                         md-item-text="brand.name"
                         md-floating-label="Enseigne">
            <md-item-template>
                <span md-highlight-text="searchBrand" md-highlight-flags="^i">{{brand.name}}</span>
            </md-item-template>
            <md-not-found>
                No matches found for "{{searchBrand}}".
            </md-not-found>
        </md-autocomplete>
        <div flex="50" ng-repeat="store in stores | filter: newUser.brand.name">
            <md-checkbox ng-checked="exists(store, newUser.stores)" ng-click="toggle(store, newUser.stores)">
                {{ store.name }}
            </md-checkbox>
        </div>
        <md-button class="md-primary md-raised" type="submit">Valider</md-button>
        <md-button class="md-warn md-raised" ng-click="$parent.createUser = false">Annuler</md-button>
    </form>
</div>
<div class="column large-12" ng-repeat="user in filteredUsers = (users | filter: filter) | orderBy:predicate:reverse | limitTo: limit">
    <md-divider class="column large-12" ng-if="!$first"></md-divider>
    <div class="padding10 float-left width100p">
        <div class="width100p float-left center" ng-show="!refactor">
            <h5 class="column medium-2">{{user.name}}</h5>
            <h5 class="column medium-2">{{user.firstName}}</h5>
            <h5 class="column medium-2">{{user.brand.name}}</h5>
            <h5 class="column medium-2">{{user.isActive}}</h5>
            <h5><i class="column medium-2 pointer fa fa-pencil"
                   ng-click="copyUser($index); refactor = true"></i></h5>
            <h5><i class="column medium-2 pointer fa fa-trash" ng-click="confirmRemove = !confirmRemove"></i></h5>
        </div>
        <div ng-if="confirmRemove" class="float-right md-whiteframe-z1">
            <div class="float-left padding10">
                Etes-vous sur de vouloir suprimer ce utilisateur ?
                <md-button class="md-primary md-raised" ng-click="$parent.confirmRemove = false; remove($index)">
                    Oui
                </md-button>
                <md-button class="md-primary md-raised" ng-click="$parent.confirmRemove = false">
                    Non
                </md-button>
            </div>
        </div>
        <md-list ng-if="refactor" class="md-whiteframe-z1">
            <form ng-submit="refactorUser($index); $parent.refactor = false">
                <i class="md-warn relative fa fa-times-circle"
                   style="font-size: 30px;right: -15px;float: right;top: -22px;"
                   ng-click="$parent.refactor = false"></i>
                <md-subheader>Modifer le utilisateur {{user.name}}</md-subheader>
                <md-divider></md-divider>
                <md-autocomplete flex required
                                 md-no-cache="noCache"
                                 md-selected-item="user.newUser.brand"
                                 md-search-text-change="searchTextChange(searchBrand)"
                                 md-search-text="searchBrand"
                                 md-selected-item-change="selectedIBrandChange(brand)"
                                 md-items="brand in querySearchBrand(searchBrand)"
                                 md-item-text="brand.name"
                                 md-min-length="0"
                                 md-floating-label="Enseigne">
                    <md-item-template>
                        <span md-highlight-text="searchBrand" md-highlight-flags="^i">{{brand.name}}</span>
                    </md-item-template>
                    <md-not-found>
                        No matches found for "{{searchBrand}}".
                    </md-not-found>
                </md-autocomplete>
                <md-input-container>
                    <label>Nom</label>
                    <input type="text" ng-model="user.newUser.name">
                </md-input-container>
                <md-input-container>
                    <label>Référent</label>
                    <input type="text" ng-model="user.newUser.contactName">
                </md-input-container>
                <md-input-container>
                    <label>Adresse de livraison</label>
                    <input type="text" ng-model="user.newUser.deliveryAddress">
                </md-input-container>
                <md-input-container>
                    <label>Adresse de facturation</label>
                    <input type="text" ng-model="user.newUser.billingAddress">
                </md-input-container>
                <md-autocomplete flex
                                 md-no-cache="noCache"
                                 md-selected-item="user.newUser.area"
                                 md-search-text-change="searchTextChange(searchText)"
                                 md-search-text="searchText"
                                 md-selected-item-change="selectedItemChange(item)"
                                 md-items="item in querySearch(searchText)"
                                 md-item-text="item.name"
                                 md-min-length="0"
                                 md-floating-label="Région">
                    <md-item-template>
                        <span md-highlight-text="searchText" md-highlight-flags="^i">{{item.name}}</span>
                    </md-item-template>
                    <md-not-found>
                        No matches found for "{{searchText}}".
                    </md-not-found>
                </md-autocomplete>
                <md-input-container>
                    <label>Numero de téléphone</label>
                    <input type="text" ng-model="user.newUser.phone">
                </md-input-container>
                <md-input-container>
                    <label>Prix d'une bâche (prix m2)</label>
                    <input type="number" step="any" ng-model="user.newUser.priceByM2">
                </md-input-container>
                <md-input-container>
                    <label>Longueur du tube</label>
                    <input type="number" step="any" ng-model="user.newUser.pipeSize">
                </md-input-container>
                <md-input-container>
                    <label>Poid de la bache</label>
                    <input type="number" step="any" ng-model="user.newUser.weight">
                </md-input-container>
                <md-input-container>
                    <label>Format d'impression</label>
                    <input type="text" ng-model="user.newUser.printFormat">
                </md-input-container>
                <md-input-container>
                    <label>Laize utilisé</label>
                    <input type="number" step="any" ng-model="user.newUser.width">
                </md-input-container>
                <md-input-container>
                    <label>Longueur du jonc</label>
                    <input type="number" step="any" ng-model="user.newUser.caneWidth">
                </md-input-container>
                <md-input-container>
                    <label>Nombre de moteurs</label>
                    <input type="number" ng-model="user.newUser.enginesNumber">
                </md-input-container>
                <md-button class="md-primary md-raised" type="submit">Valider</md-button>
                <md-button class="md-warn md-raised" ng-click="$parent.refactor = false">Annuler</md-button>
            </form>
        </md-list>
    </div>
</div>
<md-button ng-show="filteredUsers.length > limit"
           ng-click="limit = limit + 20"
           class="md-primary md-raised">Voir plus</md-button>